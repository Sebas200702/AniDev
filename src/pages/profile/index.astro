---
import Layout from '@layouts/base.astro'
import { createImageUrlProxy } from '@utils/craete-imageurl-proxy'
import { Image } from 'astro:assets'
import { UserList } from '@components/profile/user-tabs/user-list'
import { getSessionUserInfo } from '@utils/get_session_user_info'
const sesionUserInfo = await getSessionUserInfo({ request: Astro.request })
---

<Layout title="Profile">
  <section class="mx-auto mt-16 flex w-full flex-col gap-8 p-4 text-white">
    <picture class="absolute inset-0 h-80 w-full max-w-full overflow-hidden">
      <Image
        src={createImageUrlProxy(
          'https://media.kitsu.app/anime/cover_images/3936/original.jpg',
          '1920',
          '50',
          'webp'
        )}
        alt="Profile backdrop-blur"
        loading="lazy"
        fetchpriority="high"
        class="absolute inset-0 h-full w-full object-cover object-center"
        width={225}
        height={330}
        quality={10}
      />
    </picture>
    <div
      class="absolute top-0 left-0 h-80 w-full bg-gradient-to-l from-transparent to-[#121212]/100 xl:w-[70%]"
    >
    </div>
    <article
      class="z-10 mt-2 flex w-full flex-row items-center gap-4 p-4 text-white md:ml-14 md:gap-10"
    >
      <img
        src={sesionUserInfo?.avatar ??
          'https://flowbite.com/docs/images/people/profile-picture-5.jpg'}
        alt="Profile Avatar"
        class="h-24 w-24 rounded-full md:h-40 md:w-40"
      />
      <div class="flex flex-col gap-6">
        <h2 class="text-2xl font-bold md:text-4xl">
          {sesionUserInfo?.name ?? 'Guest'}
        </h2>
      </div>
    </article>
    <div class="relative">
      <UserList client:visible />
    </div>
  </section>
</Layout>
